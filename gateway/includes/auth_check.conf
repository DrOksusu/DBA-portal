# Common auth check configuration
# Include this in protected locations

auth_request /internal/auth/verify;
auth_request_set $user_id $upstream_http_x_user_id;
auth_request_set $clinic_id $upstream_http_x_clinic_id;
auth_request_set $user_role $upstream_http_x_user_role;
auth_request_set $user_name $upstream_http_x_user_name;
auth_request_set $user_email $upstream_http_x_user_email;
auth_request_set $user_permissions $upstream_http_x_user_permissions;
